<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Templates — Zion Advisor</title>
  <meta name="description" content="Download professional templates from Zion Advisor — M&A Databook, Financial Model, and Infrastructure Advisory formats." />

  <!-- Fonts & Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;800&display=swap" rel="stylesheet">

  <!-- Site CSS -->
  <link rel="stylesheet" href="/styles.css" />

  <style>
    /* Page-scoped styles for Templates page */
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}

    /* Banner uses the same structure as case-studies (svc-banner .inner) */
    .svc-banner {
      position: relative;
      background-position: center;
      background-size: cover;
      background-repeat: no-repeat;
      color: #fff;
      min-height: 180px;
      display:block;
      overflow:hidden;
    }

    .svc-banner::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, rgba(6,18,30,0.55) 0%, rgba(6,18,30,0.55) 100%);
      z-index: 1;
    }

    .svc-banner .inner {
      position: relative;
      z-index: 2;
      max-width: 1100px;
      margin: 0 auto;
      padding: 36px 20px;
    }

    .svc-banner .inner h1 {
      margin: 0 0 8px;
      font-weight: 800;
      font-size: clamp(24px, 3.6vw, 36px);
      color: #ffffff;
      line-height: 1.12;
    }

    .svc-banner .inner p {
      color: rgba(255,255,255,0.92);
      margin: 6px 0 0;
      max-width: 900px;
    }

    /* Template cards and gate */
    .template-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-top:20px}
    .template-card{background:#fff;border:1px solid #e6edf4;border-radius:12px;padding:20px;box-shadow:0 2px 5px rgba(0,0,0,.04)}
    .template-card h2{margin:0 0 8px;font-size:20px;color:#0a2239}
    .template-card p{margin:0 0 12px;color:#4a5568;font-size:14px;line-height:1.5}
    .btn-download{display:inline-flex;align-items:center;gap:8px;background:#0b66c2;color:#fff;
      padding:9px 14px;border-radius:8px;text-decoration:none;font-size:14px;font-weight:700;transition:.2s}
    .btn-download:hover{background:#094d94}
    .gate{max-width:520px;margin:0 auto;text-align:center}
    .gate .row{display:grid;gap:12px;text-align:left}
    .gate input{width:100%;padding:10px;border:1px solid #cdd6e1;border-radius:8px}
    .btn{display:inline-flex;align-items:center;gap:8px;background:#2bd887;color:#0b1118;
      padding:10px 16px;border-radius:10px;font-weight:800;text-decoration:none}
    .small{font-size:13px;color:#6b7480}

    @media (max-width:900px){
      .svc-banner .inner { padding: 28px 18px; text-align: left; }
      .svc-banner .inner h1 { font-size: 26px; }
    }
  </style>
</head>
<body>

  <!-- Header (loaded from partial) -->
  <div id="header-placeholder"></div>

  <!-- Banner (uses svc-banner markup so overlay & white text match Case Studies) -->
  <section class="svc-banner" role="img" aria-label="Templates banner"
    style="background-image: url('/assets/banner-templates.jpg');">
    <div class="inner">
      <p class="eyebrow">TEMPLATES</p>
      <h1>Professional frameworks and ready-to-use models for analysts & advisors</h1>
      <p>
        Access investor-grade databooks, financial models, and transaction advisory packs — built for efficiency, clarity, and impact.
      </p>
    </div>
  </section>

  <!-- Main Content -->
  <main class="container section" id="main" style="padding-top:26px;">
    <h1>Templates</h1>
    <p class="small" style="max-width:820px">
      Zion Advisor provides professional-grade templates to help founders, analysts, and institutions save time.
      Download free resources and start working smarter.
    </p>

    <!-- Template cards -->
    <div class="template-grid" aria-label="Template previews" style="margin-top:22px;">
      <article class="template-card">
        <h2>M&amp;A Databook Template</h2>
        <p>Investor-ready databook skeleton with PL, BS, cash flow, and reconciled schedules (ARR, churn, NWC). Clean structure for quick customization.</p>
        <span class="small">File: Excel (.xlsx) — unlocked after form</span>
      </article>

      <article class="template-card">
        <h2>Financial Model Starter</h2>
        <p>Pre-built 3-statement model with drivers, scenarios, and sensitivity tabs. A reliable base for founder and analyst workflows.</p>
        <span class="small">File: Excel (.xlsx) — unlocked after form</span>
      </article>

      <article class="template-card">
        <h2>Infrastructure &amp; Transaction Advisory Template</h2>
        <p>A practical package to support feasibility, valuation, and transaction readiness: investor-ready financial schedules, PPP readiness checklist, risk allocation table, and milestone tracker.</p>
        <span class="small">File: ZIP (.xlsx + .docx + .pptx) — unlocked after form</span>
      </article>
    </div>
  </main>

  <!-- Lead Capture / Gate -->
  <section class="container section" style="margin-top:18px;margin-bottom:40px;">
    <h2 style="text-align:center;margin-bottom:10px">Access Templates</h2>
    <p style="text-align:center;max-width:640px;margin:0 auto 18px" class="small">
      Please fill in your details to unlock the downloads. We’ll never spam you — this helps us keep these resources free.
    </p>

    <!-- Unlock form -->
    <form id="unlockForm" class="gate" novalidate>
      <div class="row">
        <label>Name<br><input type="text" name="name" required></label>
        <label>Email<br><input type="email" name="email" required></label>
        <input type="text" name="hp" autocomplete="off" tabindex="-1" style="position:absolute;left:-9999px;opacity:0">
      </div>
      <button type="submit" class="btn" style="margin-top:14px">
        <i class="fa-solid fa-unlock"></i> Unlock Downloads
      </button>
      <p id="unlockMsg" class="small" style="display:none;margin-top:8px">Unlocking…</p>
    </form>

    <!-- Downloads (hidden until unlocked) -->
    <div id="downloads" style="display:none;margin-top:22px;text-align:center">
      <p class="small" style="margin-bottom:14px;color:#2a3440">✅ Thank you — downloads are unlocked.</p>
      <div style="display:flex;gap:14px;justify-content:center;flex-wrap:wrap">
        <a data-dl href="/templates/databook-template.xlsx" class="btn-download" download>
          <i class="fa-solid fa-file-excel"></i> Databook
        </a>
        <a data-dl href="/templates/financial-model.xlsx" class="btn-download" download>
          <i class="fa-solid fa-file-excel"></i> Financial Model
        </a>
        <a data-dl href="/templates/infrastructure-advisory-pack.zip" class="btn-download" download>
          <i class="fa-solid fa-file-zipper"></i> Infrastructure & Transaction Advisory Pack
        </a>
      </div>
    </div>
  </section>

  <!-- Footer (partial) -->
  <div id="footer-placeholder"></div>

  <!-- Scripts -->
  <script>
    // include header/footer partials
    async function includeHTML(id, file) {
      const el = document.getElementById(id);
      if (!el) return;
      const resp = await fetch(file);
      el.innerHTML = await resp.text();
    }

    includeHTML("header-placeholder", "/partials/header.html").then(()=>{
      const btn=document.getElementById('burgerBtn'),nav=document.getElementById('siteNav');
      btn?.addEventListener('click',()=>nav.classList.toggle('show'));
      const path=location.pathname.replace(/\/index\.html$/,'/');
      document.querySelectorAll('.nav-links a').forEach(a=>{
        if(a.getAttribute('href')===path) a.setAttribute('aria-current','page');
      });
    });

    includeHTML("footer-placeholder", "/partials/footer.html").then(()=>{
      // optional footer link highlight
    });

    // form + unlocking logic (same as your original)
    const GAS_URL="https://script.google.com/macros/s/AKfycbylq21b_339gnhLUeGVe8eMDW36otKYxMHwYE01rbTr3F_IhszNdKniQO1TMaxPD1V/exec";
    const form=document.getElementById('unlockForm');
    const msg=document.getElementById('unlockMsg');
    const gate=document.getElementById('downloads');

    function unlocked(){return localStorage.getItem('zion_templates_unlocked')==='1';}
    function setUnlocked(){localStorage.setItem('zion_templates_unlocked','1');}

    if(unlocked()){form.style.display='none';gate.style.display='block';}

    form?.addEventListener('submit',async(e)=>{
      e.preventDefault();msg.style.display='inline';
      const fd=new FormData(form);
      fd.set('message','Templates unlock');
      try{
        await fetch(GAS_URL,{method:'POST',body:fd,mode:'no-cors'});
        setUnlocked();form.style.display='none';gate.style.display='block';
      }catch(err){
        msg.textContent="Something went wrong. Please try again.";console.error(err);
      }
    });

    document.querySelectorAll('a[data-dl]').forEach(a=>{
      a.addEventListener('click',(ev)=>{
        if(!unlocked()){ev.preventDefault();}
      });
    });
  </script>
</body>
</html>
